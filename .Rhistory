library(tidyverse)
library(dplyr)
library(readxl)
library(tidytext)
library(vitae)
Member_Casual <- read_excel("C:/Users/Kristine/Case_Study/TripData_2020.12_V2.xlsx",
sheet = "Mem_Cas")
Member_Casual$Day_of_week <- factor(Member_Casual$Day_of_week, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
Member_Casual$Day_of_week <- factor(Member_Casual$Day_of_week, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
ggplot(Member_Casual, aes(Day_of_week, Number_of_trips, fill = Day_of_week)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1),
plot.title = element_text(hjust = .5, size = 16, face = "bold")) +
facet_wrap(~Member_casual) +
scale_fill_manual(name = "Weekdays", values = c("purple", "lightgreen", "blue", "orange", "cyan", "violet","lightblue")) +
ggtitle("Number of rides per day", subtitle = "Decemebr, 2020 - November, 2021") +
xlab("Weekdays") +
ylab("Number of rides")
Member_Casual$Date <- factor(Member_Casual$Date, levels = c("12.2020.", "01.2021.", "02.2021.", "03.2021.", "04.2021.", "05.2021.", "06.2021.", "07.2021.", "08.2021.", "09.2021.", "10.2021.", "11.2021."))
df_trips_member <- data.frame(Date = rep(c("Dec", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov"),times=2),
trips_total = c(Dec_m, Jan_m, Feb_m, Mar_m, Apr_m, May_m, Jun_m, Jul_m, Aug_m, Sep_m, Oct_m, Nov_m,
Dec_c, Jan_c, Feb_c,Mar_c, Apr_c, May_c, Jun_c, Jul_c, Aug_c, Sep_c, Oct_c, Nov_c),
member_casual = rep(c("member", "casual"),each=12))
Dec_m = sum(Member_Casual[which(Member_Casual$Date=='12.2020.' & Member_Casual$Member_casual=='member'), 1])
Jan_m = sum(Member_Casual[which(Member_Casual$Date=='01.2021.' & Member_Casual$Member_casual=='member'), 1])
Feb_m = sum(Member_Casual[which(Member_Casual$Date=='02.2021.' & Member_Casual$Member_casual=='member'), 1])
Mar_m = sum(Member_Casual[which(Member_Casual$Date=='03.2021.' & Member_Casual$Member_casual=='member'), 1])
Apr_m = sum(Member_Casual[which(Member_Casual$Date=='04.2021.' & Member_Casual$Member_casual=='member'), 1])
May_m = sum(Member_Casual[which(Member_Casual$Date=='05.2021.' & Member_Casual$Member_casual=='member'), 1])
Jun_m = sum(Member_Casual[which(Member_Casual$Date=='06.2021.' & Member_Casual$Member_casual=='member'), 1])
Jul_m = sum(Member_Casual[which(Member_Casual$Date=='07.2021.' & Member_Casual$Member_casual=='member'), 1])
Aug_m = sum(Member_Casual[which(Member_Casual$Date=='08.2021.' & Member_Casual$Member_casual=='member'), 1])
Sep_m = sum(Member_Casual[which(Member_Casual$Date=='09.2021.' & Member_Casual$Member_casual=='member'), 1])
Oct_m = sum(Member_Casual[which(Member_Casual$Date=='10.2021.' & Member_Casual$Member_casual=='member'), 1])
Nov_m = sum(Member_Casual[which(Member_Casual$Date=='11.2021.' & Member_Casual$Member_casual=='member'), 1])
Dec_c = sum(Member_Casual[which(Member_Casual$Date=='12.2020.' & Member_Casual$Member_casual=='casual'), 1])
Jan_c = sum(Member_Casual[which(Member_Casual$Date=='01.2021.' & Member_Casual$Member_casual=='casual'), 1])
Feb_c = sum(Member_Casual[which(Member_Casual$Date=='02.2021.' & Member_Casual$Member_casual=='casual'), 1])
Mar_c = sum(Member_Casual[which(Member_Casual$Date=='03.2021.' & Member_Casual$Member_casual=='casual'), 1])
Apr_c = sum(Member_Casual[which(Member_Casual$Date=='04.2021.' & Member_Casual$Member_casual=='casual'), 1])
May_c = sum(Member_Casual[which(Member_Casual$Date=='05.2021.' & Member_Casual$Member_casual=='casual'), 1])
Jun_c = sum(Member_Casual[which(Member_Casual$Date=='06.2021.' & Member_Casual$Member_casual=='casual'), 1])
Jul_c = sum(Member_Casual[which(Member_Casual$Date=='07.2021.' & Member_Casual$Member_casual=='casual'), 1])
Aug_c = sum(Member_Casual[which(Member_Casual$Date=='08.2021.' & Member_Casual$Member_casual=='casual'), 1])
Sep_c = sum(Member_Casual[which(Member_Casual$Date=='09.2021.' & Member_Casual$Member_casual=='casual'), 1])
Oct_c = sum(Member_Casual[which(Member_Casual$Date=='10.2021.' & Member_Casual$Member_casual=='casual'), 1])
Nov_c = sum(Member_Casual[which(Member_Casual$Date=='11.2021.' & Member_Casual$Member_casual=='casual'), 1])
df_trips_member <- data.frame(Date = rep(c("Dec", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov"),times=2),
trips_total = c(Dec_m, Jan_m, Feb_m, Mar_m, Apr_m, May_m, Jun_m, Jul_m, Aug_m, Sep_m, Oct_m, Nov_m,
Dec_c, Jan_c, Feb_c,Mar_c, Apr_c, May_c, Jun_c, Jul_c, Aug_c, Sep_c, Oct_c, Nov_c),
member_casual = rep(c("member", "casual"),each=12))
df_trips_member$Date <- factor(df_trips_member$Date, levels = c("Dec", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov"))
ggplot(df_trips_member, aes(Date, trips_total, fill = member_casual)) +
geom_bar(stat = 'identity') +
scale_fill_manual(" ", values=c("lightgreen","lightblue")) +
#to show numbers properly on y axis
scale_y_continuous(
labels = scales::comma_format(big.mark = ',',
decimal.mark = '.')) +
geom_text(aes(label = trips_total), vjust = 2.5, cex = 2.7) +
facet_wrap(~member_casual) +
theme_bw() +
theme(plot.title = element_text(hjust = .5, size = 16, face = "bold")) +
ggtitle("Rides dynamic through the year") +
xlab(" ") +
ylab("Number of rides")
